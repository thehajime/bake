<configuration>
  <modules>

    <module name="dce-ns3">
      <source type="mercurial">
	<attribute name="url" value="http://code.nsnam.org/furbani/ns-3-dce"/>
      </source>
       <depends_on name="readversiondef" optional="False"/>
       <depends_on name="ns-3-dev-dce" optional="False"/>
      <build type="waf" objdir="yes" sourcedir="dce">
	<attribute name="configure_arguments" value="configure --prefix=`pwd`/../build --verbose"/>
	<attribute name="post_installation" value="BASEDCE=`pwd`/..;DCE_PATH=$BASEDCE/build/bin_dce:$BASEDCE/build/bin:$BASE/build/bin;DCE_ROOT=$HOME/dce_root:$BASEDCE/build;LD_LIBRARY_PATH=$SAVE_LDLP:`pwd`/../build/lib:`pwd`/build/bin:`pwd`/../build/lib:`pwd`/../../ns-3-dev-dce/build;../build/bin/ns3test-dce --verbose"/>
      </build>
    </module>

    <module name="dce-linux">
      <source type="mercurial" sourcedir="dce1">
	<attribute name="url" value="http://code.nsnam.org/furbani/ns-3-dce"/>
 	<attribute name="module_directory" value="dce"/>
     </source>
       <depends_on name="readversiondef" optional="False"/>
       <depends_on name="ns-3-linux" optional="False"/>
       <depends_on name="ns-3-dev-dce" optional="False"/>

      <build type="waf" objdir="yes" sourcedir="dce">
	<attribute name="configure_arguments" value="configure --prefix=`pwd`/../build --enable-kernel-stack=`pwd`/../ns-3-linux --verbose"/>
	<attribute name="post_installation" value="BASEDCE=`pwd`/..;DCE_PATH=$BASEDCE/build/bin_dce:$BASEDCE/build/bin:$BASE/build/bin;DCE_ROOT=$HOME/dce_root:$BASEDCE/build;LD_LIBRARY_PATH=$SAVE_LDLP:`pwd`/../build/lib:`pwd`/build/bin:`pwd`/../build/lib:`pwd`/../../ns-3-dev-dce/build;../build/bin/ns3test-dce --verbose"/>
        <attribute name="v_PATH" value="$OBJDIR/../../readversiondef;`pwd`;`pwd`/../build/bin" />
        <attribute name="v_LD_LIBRARY" value="$OBJDIR/..;`pwd`;`pwd`/../ns-3-dev-dce/build" />
        <attribute name="v_PKG_CONFIG" value="`pwd`/../ns-3-dev-dce/build/lib/pkgconfig;$OBJDIR/../../ns-3-dev-dce/build/lib/pkgconfig" />
      </build>
    </module>

    <module name="readversiondef">
      <source type="mercurial">
	<attribute name="url" value="http://code.nsnam.org/mathieu/readversiondef"/>
      </source>
      <build type="make" objdir="yes">
	<attribute name="make_arguments" value="install PREFIX=`pwd`/../build"/>
      </build>
    </module>
     
    <module name="ns-3-dev-dce">
      <source type="mercurial">
	<attribute name="url" value="http://code.nsnam.org/ns-3-dev"/>
	<attribute name="revision" value="49dadc40be43"/>
      </source>
      <build type="waf" objdir="yes">
	<attribute name="patch" value="../dce/utils/packet-socket-upgrade-exp.patch"/>
	<attribute name="configure_arguments" value="configure --prefix=`pwd`/../build --enable-tests"/>
      </build>
    </module>

    <module name="git-kern">
      <source type="git">
	<attribute name="url" value="git://git.kernel.org/pub/scm/linux/kernel/git/davem/net-next.git"/>
	<attribute name="revision" value="fed66381d65a35198639f564365e61a7f256bf79"/>
      </source>
      <build type="none" objdir="no">
      </build>
    </module>

    <module name="ns-3-linux" built_once="true">
      <source type="mercurial">
	<attribute name="url" value="http://code.nsnam.org/furbani/ns-3-linux"/>
      </source>
      <depends_on name="git-kern" optional="False"/>
      <build type="make" objdir="no">
	<attribute name="pre_installation" value="ln -s ../git-kern net-next-2.6; sed 's/$(PWD)/`pwd`/' Makefile >a; mv a Makefile; make unpatch; make setup ;make defconfig; make config; sed s/CONFIG_PACKET=m/CONFIG_PACKET=y/ config >c2 ; mv c2 config"/>
      </build>
    </module>

  </modules>

</configuration>
